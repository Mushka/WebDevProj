<!DOCTYPE html>
<html>
<head>
	<title>FlabFix - Login</title>
	<link href='https://fonts.googleapis.com/css?family=Merriweather:700|Quicksand' rel='stylesheet' type='text/css'>
	<link id="pagestyle" rel="stylesheet" type="text/css" href="mainStyle.css">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  	
</head>
<body>
	<div id="wrapper">
		<div id="content">
			<div id="logoBox">
				<span id="logoFont">FabFlix</span>
			</div>
			<div id="loginBox">
				<!-- <div id="loginHeader"> -->
					<!-- <span id="loginHeaderFont">Log In</span> -->
				<!-- </div> -->
<!-- 				<form id="loginCredentials" action="/TomcatTest/servlet/TomcatTest" method="POST"> -->
				<form id="loginCredentials" method="POST">
					<input type="text" name="username" placeholder="Username">
					<input type="password" name="password" placeholder="Password" class="margin40T">
					<input type="submit" value="Log In" class="margin40T">
				</form>
			</div>
			<div id="signUpLink">
				<p>
					Don't have an account? <span style="text-decoration: underline;">Sign Up</span>
				</p>
			</div>
		</div>
	</div>
	
<script>

	function shake(div){                                
	    var interval = 100;                                                                                                 
	    var distance = 10;                                                                                                  
	    var times = 4;                                                                                                      

	    $(div).css('position','relative');                                                                                  

	    for(var iter=0;iter<(times+1);iter++){                                                                              
	        $(div).animate({ 
	            left:((iter%2==0 ? distance : distance*-1))
	            },interval);
	    }

	    $(div).animate({ left: 0},interval);
	}

	function createCookie(name,value,days) {
		if (days) {
			var date = new Date();
			date.setTime(date.getTime()+(days*24*60*60*1000));
			var expires = "; expires="+date.toGMTString();
		}
		else var expires = "";
		document.cookie = name+"="+value+expires+"; path=/";
	}
		
		
	function eraseCookie(name) {
		createCookie(name,"",-1);
	}

	$(document).ready(function() {

		$('#logoFont').on('click', function(){
			shake($('#loginBox'));
			$('#wrapper').append('<div id="error" class="errorMessage"><span style="align-self: center;">Invalid Credentials</span></div>');
			$('#error').animate({top:0+'px'}, {duration: 500, complete: function() {
				setTimeout(function() {
					$('#error').animate({top:-60+'px'}, {duration: 500, complete: function() {
						$('#error').remove();
					}})
				},3000);
			}});
		});

	 	$("form").on('submit', function (e) {

	 		$.ajax({
		 		/*url is the location of the servlet, i believe */
	            url : 'TryToLoginCustomer',
	            data : $(this).serialize(),
	            success : function(responseText) {
			            	
		            if(responseText === "false")
	            	{		      
	            		shake($('#loginBox'));
	            		$('#wrapper').append('<div id="error" class="errorMessage"><span style="align-self: center;">Invalid Credentials</span></div>');
						$('#error').animate({top:0+'px'}, {duration: 500, complete: function() {
							setTimeout(function() {
								$('#error').animate({top:-60+'px'}, {duration: 500, complete: function() {
									$('#error').remove();
								}})
							},3000);
						}});
	            	}
		            else
		            {
	/* 		            		http://www.quirksmode.org/js/cookies.html */
						eraseCookie("loggedin");
	    				createCookie("loggedin", responseText , 0);
	    				
	    				/* let's not link to jsp files*/
	    				window.location.href = './Search?limit=10&offset=0&title=A';
		            }
			    }
			});
	 		   
	 		e.preventDefault();
	 	});
	});
			
</script>

</body>
</html>